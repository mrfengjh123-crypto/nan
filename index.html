<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2026 快乐</title>
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background-color: #050505; }
        
        /* 动态背景照片墙 */
        #photo-wall { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; }
        .bg-photo {
            position: absolute; width: 140px; height: 190px;
            background-size: cover; background-position: center;
            border: 2px solid rgba(255,255,255,0.1); border-radius: 5px;
            opacity: 0; filter: brightness(0.4);
            animation: photoFlow 12s infinite ease-in-out;
        }

        /* 文字样式优化 */
        #text-container {
            position: absolute; left: 30px; top: 45%; color: white;
            z-index: 100; pointer-events: none;
            text-shadow: 0 0 15px rgba(255,105,180,0.8);
        }
        .line1 { font-size: 26px; font-weight: bold; margin-bottom: 5px; }
        .line2 { font-size: 14px; opacity: 0.8; letter-spacing: 1px; }

        @keyframes photoFlow {
            0% { opacity: 0; transform: scale(0.9) translateY(10px); }
            15% { opacity: 0.6; }
            85% { opacity: 0.6; }
            100% { opacity: 0; transform: scale(1.05) translateY(-10px); }
        }

        canvas { position: absolute; top: 0; left: 0; z-index: 10; }
        #loading { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); color: pink; z-index: 1000; font-size: 14px; }
    </style>
</head>
<body>
    <div id="loading">资源加载中...</div>
    <div id="photo-wall"></div>
    <div id="text-container">
        <div class="line1">2026快乐！</div>
        <div class="line2">希望我的楠楠天天快乐！</div>
    </div>
    <audio id="bgm" loop><source src="music.mp3" type="audio/mpeg"></audio>

    <script src="https://cdn.staticfile.org/three.js/r128/three.min.js"></script>
    <script>
        const photoWall = document.getElementById('photo-wall');
        const photos = ['photo1.jpg','photo2.jpg','photo3.jpg','photo4.jpg','photo5.jpg','photo6.jpg','photo7.jpg','photo8.jpg'];
        
        // 生成照片位置
        photos.forEach((src, i) => {
            const div = document.createElement('div');
            div.className = 'bg-photo';
            div.style.backgroundImage = `url(${src})`;
            div.style.left = (Math.random() * 60 + (i % 2 * 30)) + '%';
            div.style.top = (Math.random() * 70) + '%';
            div.style.animationDelay = (i * 1.5) + 's';
            photoWall.appendChild(div);
        });

        let scene, camera, renderer, spiral, heart;

        function init() {
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 1, 8);

            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            document.body.appendChild(renderer.domElement);

            // 1. 螺旋树干：增加随机散落感
            const spiralGeo = new THREE.BufferGeometry();
            const spiralPoints = 15000;
            const spiralPos = new Float32Array(spiralPoints * 3);
            const spiralColors = new Float32Array(spiralPoints * 3);

            for(let i=0; i<spiralPoints; i++) {
                const t = i / spiralPoints;
                const angle = t * Math.PI * 25;
                const radius = (1.1 - t) * 3;
                
                // 关键点：添加 Noise 随机偏移，让它零散而不死板
                const noise = (Math.random() - 0.5) * 0.4; 
                spiralPos[i*3] = Math.cos(angle) * radius + noise;
                spiralPos[i*3+1] = t * 8 - 4;
                spiralPos[i*3+2] = Math.sin(angle) * radius + (Math.random()-0.5)*0.4;

                spiralColors[i*3] = 1; 
                spiralColors[i*3+1] = 0.6 + t*0.3; 
                spiralColors[i*3+2] = 0.8;
            }
            spiralGeo.setAttribute('position', new THREE.BufferAttribute(spiralPos, 3));
            spiralGeo.setAttribute('color', new THREE.BufferAttribute(spiralColors, 3));

            // 2. 独立爱心：增加厚度
            const heartGeo = new THREE.BufferGeometry();
            const heartPoints = 2500;
            const heartPos = new Float32Array(heartPoints * 3);
            for(let i=0; i<heartPoints; i++) {
                const step = (i / heartPoints) * Math.PI * 2;
                const x = 16 * Math.pow(Math.sin(step), 3);
                const y = 13 * Math.cos(step) - 5 * Math.cos(2*step) - 2 * Math.cos(3*step) - Math.cos(4*step);
                const scale = 0.04;
                heartPos[i*3] = x * scale + (Math.random()-0.5)*0.2;
                heartPos[i*3+1] = y * scale + 4.2; // 置于树尖上方
                heartPos[i*3+2] = (Math.random()-0.5)*0.5;
            }
            heartGeo.setAttribute('position', new THREE.BufferAttribute(heartPos, 3));

            const material = new THREE.PointsMaterial({
                size: 0.12, vertexColors: true, transparent: true, opacity: 0.7,
                blending: THREE.AdditiveBlending, sizeAttenuation: true
            });

            spiral = new THREE.Points(spiralGeo, material);
            heart = new THREE.Points(heartGeo, new THREE.PointsMaterial({size: 0.1, color: 0xffb6c1, blending: THREE.AdditiveBlending}));
            
            scene.add(spiral);
            scene.add(heart);

            document.getElementById('loading').style.display = 'none';
            animate();
        }

        function animate() {
            requestAnimationFrame(animate);
            spiral.rotation.y += 0.005;
            heart.rotation.y += 0.01;
            // 爱心微弱缩放动画，增加灵动感
            const s = 1 + Math.sin(Date.now() * 0.003) * 0.05;
            heart.scale.set(s, s, s);
            renderer.render(scene, camera);
        }

        window.addEventListener('touchstart', () => { document.getElementById('bgm').play(); }, {once: true});
        init();
    </script>
</body>
</html>
